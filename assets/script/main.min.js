'use strict';cc.Class({extends:cc.Component,properties:{block1:cc.Prefab,score_Label:cc.Label,bzPrefab:cc.Prefab},onLoad(){this.prefabList=[{name:"block1",size:26,color:[110,16,100]},{name:"block2",size:40,color:[255,9,36]},{name:"block3",size:54,color:[253,11,1]},{name:"block4",size:59,color:[255,230,23]},{name:"block5",size:76,color:[110,16,100]},{name:"block6",size:91,color:[110,16,100]},{name:"block7",size:96,color:[110,16,100]},{name:"block8",size:129,color:[110,16,100]},{name:"block9",size:154,
color:[110,16,100]},{name:"block10",size:154,color:[110,16,100]},{name:"block11",size:204,color:[110,16,100]}];window.main=this;this.f_scale=.8;this.current_score=this.fruidCount=0;cc.director.getPhysicsManager().enabled=!0;this.node.on(cc.Node.EventType.TOUCH_START,a=>{});this.node.on(cc.Node.EventType.TOUCH_MOVE,a=>{console.log("TOUCH_MOVE")});this.node.on(cc.Node.EventType.TOUCH_END,a=>{a=a.getLocation();a=this.node.convertToNodeSpaceAR(a);a.y=500;let d=this.getNextFruidId();this.createBlock(a,
d)});this.node.on(cc.Node.EventType.TOUCH_CANCEL,a=>{console.log("TOUCH_CANCEL")})},getNextFruidId(){return 3>=this.fruidCount?Math.floor(3*Math.random()):Math.floor(Math.random()*(this.prefabList.length-5))},createBlock(a,d,b=!1){d>=this.prefabList.length&&(d=this.prefabList.length-1);let c=cc.instantiate(this.block1);c.setPosition(cc.v2(a.x,a.y));c.scale=this.f_scale;this.fruidCount++;b&&(c.scale=.3,a=cc.scaleTo(.15,this.f_scale),c.runAction(a),--this.fruidCount);c.getComponent("block").changeSpriteFrame(d);
c.block_type="block"+Number(d+1);a=c.getComponent(cc.PhysicsCircleCollider);b=this.prefabList.filter(e=>e.name==c.block_type);a.radius=b[0].size;console.log(d,b[0]);c.parent=this.node},createTx(a,d){let b=cc.instantiate(this.bzPrefab);b.setPosition(cc.v2(a.x,a.y));b.parent=this.node;b.scale=0;a=this.prefabList.filter(c=>c.name=="block"+Number(d+1));b.color=new cc.Color(a[0].color[0],a[0].color[1],a[0].color[2]);cc.tween(b).to(.1,{scale:.2}).call(()=>{b.removeFromParent()}).start()},addScore(){this.current_score+=
1;this.score_Label.string="score: "+this.current_score}});