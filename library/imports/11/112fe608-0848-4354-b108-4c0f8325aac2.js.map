{"version":3,"sources":["assets\\script\\main.js"],"names":["cc","Class","Component","properties","block1","Prefab","score_Label","Label","bzPrefab","onLoad","prefabList","name","size","color","window","main","f_scale","fruidCount","current_score","director","getPhysicsManager","enabled","node","on","Node","EventType","TOUCH_START","event","mouse_position","getLocation","world_position","convertToNodeSpaceAR","y","TOUCH_MOVE","console","log","TOUCH_END","typeNumber","getNextFruidId","createBlock","TOUCH_CANCEL","Math","floor","random","length","position","isScale","block_Node","instantiate","setPosition","v2","x","scale","act","scaleTo","runAction","fruit_sprit","getComponent","changeSpriteFrame","block_type","Number","physiscs_collider","PhysicsCircleCollider","fruitItem","filter","item","radius","parent","createTx","bzNode","Color","tween","to","call","removeFromParent","start","addScore","string"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    block1: cc.Prefab,\r\n    score_Label: cc.Label,\r\n    bzPrefab: cc.Prefab\r\n  },\r\n\r\n  // LIFE-CYCLE CALLBACKS:\r\n\r\n  onLoad () {\r\n    this.prefabList = [{\r\n      name: 'block1',\r\n      size: 26,\r\n      color: [110, 16, 100]\r\n    },\r\n    {\r\n      name: 'block2',\r\n      size: 40,\r\n      color: [255, 9, 36]\r\n    },\r\n    {\r\n      name: 'block3',\r\n      size: 54,\r\n      color: [253, 11, 1]\r\n    },\r\n    {\r\n      name: 'block4',\r\n      size: 59,\r\n      color: [255, 230, 23]\r\n    },\r\n    {\r\n      name: 'block5',\r\n      size: 76,\r\n      color: [110, 16, 100]\r\n    },\r\n    {\r\n      name: 'block6',\r\n      size: 91,\r\n      color: [110, 16, 100]\r\n    },\r\n    {\r\n      name: 'block7',\r\n      size: 96,\r\n      color: [110, 16, 100]\r\n    },\r\n    {\r\n      name: 'block8',\r\n      size: 129,\r\n      color: [110, 16, 100]\r\n    },\r\n    {\r\n      name: 'block9',\r\n      size: 154,\r\n      color: [110, 16, 100]\r\n    },\r\n    {\r\n      name: 'block10',\r\n      size: 154,\r\n      color: [110, 16, 100]\r\n    },\r\n    {\r\n      name: 'block11',\r\n      size: 204,\r\n      color: [110, 16, 100]\r\n    }]\r\n\r\n    window.main = this\r\n    this.f_scale = 0.8 // 整体缩小0.8\r\n    this.fruidCount = 0 // 当前屏幕的数量\r\n    this.current_score = 0 // 当前分数\r\n\r\n    // 开启物理碰撞\r\n    cc.director.getPhysicsManager().enabled = true;\r\n\r\n    // 点击屏幕开始\r\n    this.node.on(cc.Node.EventType.TOUCH_START, (event) => {\r\n      let mouse_position = event.getLocation()\r\n      let world_position = this.node.convertToNodeSpaceAR(mouse_position)\r\n      world_position.y = 500\r\n      // let typeNumber = this.getNextFruidId()\r\n      // this.createBlock(world_position, typeNumber)\r\n    })\r\n\r\n    // 点击屏幕移动\r\n    this.node.on(cc.Node.EventType.TOUCH_MOVE, event => {\r\n      console.log('TOUCH_MOVE')\r\n    })\r\n\r\n    // 点击屏幕结束\r\n    this.node.on(cc.Node.EventType.TOUCH_END, event => {\r\n      let mouse_position = event.getLocation()\r\n      let world_position = this.node.convertToNodeSpaceAR(mouse_position)\r\n      world_position.y = 500\r\n      let typeNumber = this.getNextFruidId()\r\n      // 创建预制体小球\r\n      this.createBlock(world_position, typeNumber)\r\n    })\r\n    // 取消点击屏幕\r\n    this.node.on(cc.Node.EventType.TOUCH_CANCEL, event => {\r\n      console.log('TOUCH_CANCEL')\r\n    })\r\n  },\r\n\r\n  // 获取下一个水果的id\r\n  getNextFruidId () {\r\n    if (this.fruidCount <= 3) {\r\n      return Math.floor(Math.random() * 3)\r\n    } else {\r\n      // 随机返回除了后五个之外的\r\n      return Math.floor(Math.random() * (this.prefabList.length - 5))\r\n    }\r\n  },\r\n\r\n  // create block\r\n  createBlock (position, typeNumber, isScale = false) {\r\n    if (typeNumber >= this.prefabList.length) {\r\n      typeNumber = this.prefabList.length - 1\r\n    }\r\n    let block_Node = cc.instantiate(this.block1)\r\n    block_Node.setPosition(cc.v2(position.x, position.y))\r\n\r\n    block_Node.scale = this.f_scale\r\n\r\n    this.fruidCount++ // 水果数量加一个\r\n\r\n    if (isScale) {\r\n      block_Node.scale = 0.3\r\n      let act = cc.scaleTo(0.15, this.f_scale)\r\n      block_Node.runAction(act)\r\n      // cc.tween(block_Node).to(0.15, {scale: 1})\r\n\r\n      this.fruidCount -= 1 //碰撞损耗一个\r\n    }\r\n\r\n    let fruit_sprit = block_Node.getComponent('block')\r\n    // 调用block.js方法修改sprite frame图片\r\n    fruit_sprit.changeSpriteFrame(typeNumber)\r\n    block_Node.block_type = 'block' + Number(typeNumber + 1)\r\n\r\n    let physiscs_collider = block_Node.getComponent(cc.PhysicsCircleCollider)\r\n    let fruitItem = this.prefabList.filter((item) => {\r\n      return item.name == block_Node.block_type\r\n    })\r\n\r\n    physiscs_collider.radius = fruitItem[0].size\r\n    console.log(typeNumber, fruitItem[0]);\r\n\r\n    block_Node.parent = this.node\r\n  },\r\n\r\n  // 添加特效\r\n  createTx (position, typeNumber) {\r\n    let bzNode = cc.instantiate(this.bzPrefab)\r\n    bzNode.setPosition(cc.v2(position.x, position.y))\r\n    bzNode.parent = this.node\r\n    bzNode.scale = 0\r\n\r\n    let fruitItem = this.prefabList.filter((item) => {\r\n      return item.name == 'block' + Number(typeNumber + 1)\r\n    })\r\n\r\n    bzNode.color = new cc.Color(fruitItem[0].color[0], fruitItem[0].color[1], fruitItem[0].color[2])\r\n\r\n    cc.tween(bzNode).to(0.1, { scale: 0.2 }).call(() => {\r\n      bzNode.removeFromParent()\r\n    }).start()\r\n  },\r\n\r\n  // 添加分数\r\n  addScore () {\r\n    this.current_score += 1\r\n    this.score_Label.string = 'score: ' + this.current_score\r\n  }\r\n});\r\n"]}